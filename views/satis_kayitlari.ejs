<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>SatÄ±ÅŸ KayÄ±tlarÄ± - SuperStep KDS</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        :root { --sidebar-bg: #5e0000ef; --bg-color: #f3f4f6; --sidebar-active: #bc0b0bff;
            --accent-color: #ff0000ff; }
        body { font-family: 'Inter', sans-serif; background-color: var(--bg-color); }
        .sidebar { width: 260px; background-color: var(--sidebar-bg); min-height: 100vh; position: fixed; top: 0; left: 0; padding-top: 20px; z-index: 1000; }
        .sidebar-logo {
    height: 72px;              /* ðŸ‘ˆ sidebar Ã¼st alanÄ± net */
    padding: 0 20px;           /* SADECE saÄŸ-sol */
    margin: 0;
    display: flex;
    align-items: center;       /* dikey tam ortalama */
    justify-content: flex-start;
    border-bottom: 1px solid rgba(255,255,255,0.15);
}
       .sidebar-logo-img {
    width: 100%;
    max-width: 400px;
    height: auto;
    display: block;
    margin: 0;           /* ðŸ‘ˆ alt boÅŸluk biter */
}
        .sidebar-menu { list-style: none; padding: 0; }
        .menu-header { font-size: 11px; text-transform: uppercase; color: #b77a7aff; padding: 10px 24px; font-weight: 600; margin-top: 10px; }
        .menu-item a { display: flex; align-items: center; padding: 12px 24px; color: #e5e5e5ff;; text-decoration: none; font-size: 14px; transition: 0.2s; border-left: 3px solid transparent; }
        .menu-item a:hover, .menu-item a.active {
            background-color: var(--sidebar-active);
            color: white;
            border-left-color: var(--accent-color);
        }
        .menu-item i { width: 24px; }
        .main-content { margin-left: 260px; padding: 30px; }

        .white-card { background: white; border-radius: 12px; padding: 24px; box-shadow: 0 1px 3px rgba(0,0,0,0.05); margin-bottom: 24px; border: 1px solid #e5e7eb; box-shadow: 0 1px 3px #ff0000ff;}
        
        .table-custom th { background-color: #f9fafb; font-size: 11px; text-transform: uppercase; color: #6b7280; font-weight: 700; border-bottom: 2px solid #e5e7eb; padding: 12px; }
        .table-custom td { padding: 12px; vertical-align: middle; border-bottom: 1px solid #f3f4f6; font-size: 13px; color: #374151; }
        
        .badge-kds { padding: 4px 8px; border-radius: 4px; font-size: 11px; font-weight: 600; }
        .text-truncate-custom { max-width: 200px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }

 
    </style>
</head>
<body>

    <aside class="sidebar">
       <div class="sidebar-logo">
    <img src="/images/superstep_logo.png" class="sidebar-logo-img">
</div>

        <ul class="sidebar-menu">
            <li class="menu-header">GENEL</li>
            <li class="menu-item">
                <a href="/dashboard"><i class="fa-solid fa-house"></i> Genel Dashboard</a>
            </li>
            <li class="menu-item">
                <a href="/sube-performansi"><i class="fa-solid fa-store"></i> Åžube PerformansÄ±</a>
            </li>
            <li class="menu-item">
                <a href="/musteri-segmentleri"><i class="fa-solid fa-users"></i> MÃ¼ÅŸteri Segmentleri</a>
            </li>
            <li class="menu-item">
                <a href="/urun-analizi">
                    <i class="fa-solid fa-box-open"></i> ÃœrÃ¼n ve Stok Analizi
                   
                </a>
            </li>
            
            <li class="menu-header">YÃ–NETÄ°M</li>
            <li class="menu-item">
                <a href="/kampanya-simulasyonu"><i class="fa-solid fa-wand-magic-sparkles"></i> Kampanya SimÃ¼lasyonu</a>
            </li>
            <li class="menu-item">
               <a href="/satis-kayitlari"><i class="fa-solid fa-file-invoice"></i> SatÄ±ÅŸ KayÄ±tlarÄ±</a>
            </li>
            
            <li class="menu-item">
    <a href="/gelecek-tahmini"><i class="fa-solid fa-arrow-trend-up"></i> Gelecek Tahmini</a>
</li>

            <li class="menu-header">AYARLAR</li>
            <li class="menu-item">
                <a href="/kullanicilar"><i class="fa-solid fa-user-gear"></i> KullanÄ±cÄ± YÃ¶netimi</a>
            </li>
        </ul>
    </aside>

    <main class="main-content">
        
        <div class="d-flex justify-content-between align-items-center mb-4">
            <div>
                <h3 class="fw-bold text-dark m-0">SatÄ±ÅŸ KayÄ±tlarÄ± (Ham Veri)</h3>
                <p class="text-muted m-0" style="font-size: 14px;">TÃ¼m iÅŸlem geÃ§miÅŸi, detaylÄ± filtreleme ve denetim.</p>
            </div>
            
            <form action="/satis-kayitlari" method="GET" class="d-flex gap-2">
                <select name="sube" class="form-select form-select-sm" style="width: 200px;" onchange="this.form.submit()">
                    <option value="hepsi">TÃ¼m Åžubeler</option>
                    <% tumSubeler.forEach(s => { %>
                        <option value="<%= s.branch_name %>" <%= filtre.sube == s.branch_name ? 'selected' : '' %>>
                            <%= s.branch_name %>
                        </option>
                    <% }) %>
                </select>
            </form>
        </div>

        <div class="white-card p-0 overflow-hidden">
            <div class="table-responsive">
                <table class="table table-custom table-hover m-0">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Tarih</th>
                            <th>Åžube</th>
                            <th>ÃœrÃ¼n & Kategori</th>
                            <th>MÃ¼ÅŸteri</th>
                            <th class="text-center">Adet</th>
                            <th class="text-end">Tutar</th>
                            <th class="text-end">KÃ¢r</th>
                        </tr>
                    </thead>
                    <tbody>
                        <% satislar.forEach(satis => { %>
                            <tr>
                                <td class="text-muted">#<%= satis.sale_id %></td>
                                <td>
                                    <i class="fa-regular fa-calendar me-1 text-muted"></i>
                                    <%= new Date(satis.sale_date).toLocaleDateString('tr-TR') %>
                                </td>
                                <td>
                                    <span class="fw-bold text-dark"><%= satis.branch_name.replace('SuperStep â€“ ', '') %></span>
                                </td>
                                <td>
                                    <div class="fw-bold text-dark"><%= satis.product_name %></div>
                                    <div class="text-muted" style="font-size:11px;"><%= satis.category %></div>
                                </td>
                                <td>
                                    <% if(satis.customer_segment == 'Sadik Musteri') { %>
                                        <span class="badge-kds bg-primary-subtle text-primary border border-primary-subtle">SadÄ±k</span>
                                    <% } else { %>
                                        <span class="badge-kds bg-secondary-subtle text-secondary border border-secondary-subtle">Yeni</span>
                                    <% } %>
                                </td>
                                <td class="text-center">
                                    <span class="badge bg-light text-dark border px-2"><%= satis.quantity %></span>
                                </td>
                                <td class="text-end fw-bold text-dark">
                                    <%= Number(satis.toplam_tutar).toLocaleString('tr-TR', {style:'currency', currency:'TRY', maximumFractionDigits:0}) %>
                                </td>
                                <td class="text-end">
                                    <% if(satis.kar > 5000) { %>
                                        <span class="text-success fw-bold">+<%= Number(satis.kar).toLocaleString('tr-TR', {maximumFractionDigits:0}) %> â‚º</span>
                                    <% } else { %>
                                        <span class="text-muted">+<%= Number(satis.kar).toLocaleString('tr-TR', {maximumFractionDigits:0}) %> â‚º</span>
                                    <% } %>
                                </td>
                            </tr>
                        <% }) %>
                        
                        <% if(satislar.length === 0) { %>
                            <tr>
                                <td colspan="8" class="text-center py-5 text-muted">
                                    <i class="fa-solid fa-inbox fs-1 mb-3 opacity-25"></i><br>
                                    Bu kriterlere uygun kayÄ±t bulunamadÄ±.
                                </td>
                            </tr>
                        <% } %>
                    </tbody>
                </table>
            </div>

            <div class="p-3 border-top bg-light d-flex justify-content-between align-items-center">
                <div class="text-muted" style="font-size:12px;">
                    Toplam <strong><%= toplamSayfa %></strong> sayfa
                </div>
                
                <nav>
                    <ul class="pagination pagination-sm m-0">
                        <li class="page-item <%= suankiSayfa <= 1 ? 'disabled' : '' %>">
                            <a class="page-link" href="/satis-kayitlari?sayfa=<%= suankiSayfa - 1 %>&sube=<%= filtre.sube %>">Ã–nceki</a>
                        </li>

                        <li class="page-item active">
                            <span class="page-link"><%= suankiSayfa %></span>
                        </li>

                        <li class="page-item <%= suankiSayfa >= toplamSayfa ? 'disabled' : '' %>">
                            <a class="page-link" href="/satis-kayitlari?sayfa=<%= suankiSayfa + 1 %>&sube=<%= filtre.sube %>">Sonraki</a>
                        </li>
                    </ul>
                </nav>
            </div>
        </div>

    </main>

    </body>
</html>